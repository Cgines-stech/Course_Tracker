<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Open‑Entry Course Calendar Generator</title>
  <meta name="description" content="Generate a personalized class calendar for open-entry courses and export to CSV/ICS." />
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-slate-50">
  <header class="sticky top-0 z-10 bg-white/80 backdrop-blur border-b border-slate-200">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <h1 class="text-xl md:text-2xl font-bold tracking-tight">Open‑Entry Course Calendar Generator</h1>
      <a class="text-sm text-blue-600 hover:underline" href="#about">About</a>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-6 grid md:grid-cols-3 gap-6">
    <!-- Left: Form -->
    <section class="md:col-span-1 card">
      <h2 class="text-lg font-semibold mb-4">Create Your Schedule</h2>

      <!-- Program & Course selectors -->
      <div class="space-y-3">
        <label class="block">
          <span class="block text-sm font-medium text-slate-700">Program</span>
          <select id="program" class="mt-1 w-full rounded-xl border-slate-300 focus:border-blue-500 focus:ring-blue-500"></select>
        </label>

        <label class="block">
          <span class="block text-sm font-medium text-slate-700">Course</span>
          <select id="course" class="mt-1 w-full rounded-xl border-slate-300 focus:border-blue-500 focus:ring-blue-500"></select>
        </label>

        <div class="grid grid-cols-2 gap-3">
          <label class="block">
            <span class="block text-sm font-medium text-slate-700">Start Date</span>
            <input id="startDate" type="date" class="mt-1 w-full rounded-xl border-slate-300 focus:border-blue-500 focus:ring-blue-500"/>
          </label>
          <label class="block">
            <span class="block text-sm font-medium text-slate-700">Default Start Time</span>
            <input id="startTime" type="time" value="09:00" class="mt-1 w-full rounded-xl border-slate-300 focus:border-blue-500 focus:ring-blue-500"/>
          </label>
        </div>

        <p class="text-sm text-slate-600">Pick the days you plan to attend and set hours for each selected day. Only days allowed by the course will be enabled.</p>

        <!-- Day/hour grid -->
        <div id="daysGrid" class="grid grid-cols-2 gap-2 mt-1"></div>

        <!-- Completed hours input (NEW) -->
        <label class="block">
          <span class="block text-sm font-medium text-slate-700">Hours Already Completed (optional)</span>
          <input id="completedHours" type="number" step="0.25" min="0" placeholder="e.g., 18" class="mt-1 w-full rounded-xl border-slate-300 focus:border-blue-500 focus:ring-blue-500" />
        </label>

        <!-- Optional: Add personal blackout dates -->
        <details class="mt-3">
          <summary class="text-sm font-medium cursor-pointer select-none">Add personal no-class dates (optional)</summary>
          <div class="mt-2 space-y-2">
            <div class="flex gap-2">
              <input id="blkInput" type="date" class="w-full rounded-xl border-slate-300 focus:border-blue-500 focus:ring-blue-500" />
              <button id="blkAdd" class="px-3 py-2 rounded-xl bg-slate-800 text-white hover:bg-slate-700">Add</button>
            </div>
            <ul id="blkList" class="text-sm list-disc pl-5 text-slate-700"></ul>
          </div>
        </details>

        <button id="generate" class="w-full mt-3 py-3 rounded-2xl bg-blue-600 text-white font-semibold hover:bg-blue-700">Generate Schedule</button>
      </div>

      <hr class="my-5"/>

      <!-- Course facts from config -->
      <div class="text-sm text-slate-700">
        <p><span class="font-medium">Program:</span> <span id="infoProgram">—</span></p>
        <p><span class="font-medium">Course:</span> <span id="infoCourse">—</span></p>
        <p><span class="font-medium">Total Hours:</span> <span id="infoHours">—</span></p>
        <p><span class="font-medium">Allowed Days:</span> <span id="infoDays">—</span></p>
      </div>

      <!-- Admin preview -->
      <details class="mt-5" id="adminPanel">
        <summary class="font-semibold cursor-pointer">Admin / Backend Settings</summary>
        <p class="text-sm text-slate-600 mt-2">Edit <code>APP_CONFIG</code> in <code>script.js</code> to control programs, courses, total hours, allowed days, and global holidays.</p>
        <textarea id="configPreview" class="mt-2 w-full h-48 rounded-xl border-slate-300 text-xs font-mono p-3" readonly></textarea>
      </details>
    </section>

    <!-- Right: Output -->
    <section class="md:col-span-2 space-y-6">
      <div class="card">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
          <div>
            <h2 class="text-lg font-semibold">Planned Sessions</h2>
            <p class="text-sm text-slate-600">Auto-built from your selections until total hours are met. Holidays/blackouts are skipped.</p>
          </div>
          <div class="flex gap-2">
            <button id="dlCsv" disabled class="px-4 py-2 rounded-xl bg-slate-200 text-slate-600 disabled:opacity-60">Download CSV</button>
            <button id="dlIcs" disabled class="px-4 py-2 rounded-xl bg-slate-800 text-white disabled:opacity-60">Download ICS</button>
          </div>
        </div>
        <div class="overflow-auto mt-4">
          <table class="min-w-full text-sm">
            <thead>
              <tr class="bg-slate-100 text-slate-700">
                <th class="text-left p-2">#</th>
                <th class="text-left p-2">Date</th>
                <th class="text-left p-2">Weekday</th>
                <th class="text-right p-2">Hours</th>
                <th class="text-right p-2">Cumulative</th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
        <div class="mt-3 text-sm text-slate-700 grid md:grid-cols-2 gap-3">
          <p><span class="font-medium">Projected Finish:</span> <span id="projFinish">—</span></p>
          <p><span class="font-medium">Sessions Count:</span> <span id="sessCount">0</span></p>
          <p><span class="font-medium">Scheduled Hours ≤ Today:</span> <span id="schedToDate">0</span></p>
          <p><span class="font-medium">Completed Hours (input):</span> <span id="completedOut">0</span></p>
          <p><span class="font-medium">% Complete (actual):</span> <span id="pctActual">0%</span></p>
          <p><span class="font-medium">% Expected by Today:</span> <span id="pctExpected">0%</span></p>
          <p class="md:col-span-2"><span class="font-medium">On Track?</span> <span id="onTrack" class="inline-block px-2 py-1 rounded-lg bg-slate-200">—</span></p>
        </div>
      </div>

      <div id="about" class="card">
        <h2 class="text-lg font-semibold">About</h2>
        <p class="text-sm text-slate-700">Static app for GitHub Pages. Admins control Programs, Courses, total hours, allowed days, and global holidays via <code>APP_CONFIG</code> (script.js). Students pick a start date and weekly availability; the app builds a schedule and lets them export CSV/ICS.</p>
        <ol class="text-sm text-slate-700 list-decimal pl-5 mt-2 space-y-1">
          <li><strong>Deploy:</strong> Add these three files to a GitHub repo and enable GitHub Pages.</li>
          <li><strong>Configure:</strong> Edit <code>APP_CONFIG</code> in <code>script.js</code>.</li>
          <li><strong>Share:</strong> Distribute the Pages URL.</li>
        </ol>
      </div>
    </section>
  </main>

  <script src="script.js"></script>
</body>
</html>